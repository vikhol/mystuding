function init(){document.getElementById("fireButton").onclick=function(){var e=document.getElementById("guessInput"),s=e.value;controller.processGuess(s),e.value=""},document.getElementById("guessInput").onkeypress=function(e){var s=document.getElementById("fireButton");if(13===e.keyCode)return s.click(),!1},model.generateShipLocations()}var view={displayMessage:function(e){document.getElementById("messageArea").innerHTML=e},displayHit:function(e){document.getElementById(e).setAttribute("class","hit")},displayMiss:function(e){document.getElementById(e).setAttribute("class","miss")},displayGuesses:function(e){document.getElementById("guessesArea").innerHTML=e},displayAllHits:function(e){document.getElementById("hitsArea").innerHTML=e},displayAccuracy:function(e){document.getElementById("accuracyArea").innerHTML=e}},model={ships:[{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]}],boardSize:7,numShips:3,shipsSunk:0,shipLength:3,allHits:0,generateShip:function(){var e,s,i=Math.floor(2*Math.random());1===i?(e=Math.floor(Math.random()*this.boardSize),s=Math.floor(Math.random()*(this.boardSize-this.shipLength+1))):(e=Math.floor(Math.random()*(this.boardSize-this.shipLength+1)),s=Math.floor(Math.random()*this.boardSize));for(var t=[],n=0;n<this.shipLength;n++)1===i?t.push(e+""+(s+n)):t.push(e+n+""+s);return console.log(t),t},generateShipLocations:function(){for(var e,s=0;s<this.numShips;s++){do{e=this.generateShip()}while(this.collision(e));this.ships[s].locations=e}},collision:function(e){for(var s=0;s<this.numShips;s++)for(var i=model.ships[s],t=0;t<e.length;t++)if(i.locations.indexOf(e[t])>=0)return!0;return!1},showGuessAndPercent:function(){view.displayAllHits("Попаданий: "+this.allHits),view.displayAccuracy("Точность: "+Math.floor(Math.round(this.allHits/controller.guesses*100)/100*100)+"%")},fire:function(e){for(var s=0;s<this.numShips;s++){var i=this.ships[s],t=i.locations.indexOf(e);if(t>=0)return i.hits[t]="hit",view.displayHit(e),view.displayMessage("ПОПАДАНИЕ!"),this.allHits++,this.isSunk(i)&&(this.shipsSunk++,view.displayMessage("Корабль потоплен")),this.showGuessAndPercent(),!0}return this.showGuessAndPercent(),view.displayMessage("Промах"),view.displayMiss(e),!1},isSunk:function(e){for(var s=0;s<this.shipLength;s++)if("hit"!==e.hits[s])return!1;return!0}},controller={guesses:0,processGuess:function(e){var s=function(e){var s=["A","B","C","D","E","F","G"];if(null!==e&&2===e.length){var i=e.charAt(0).toUpperCase(),t=s.indexOf(i),n=e.charAt(1);if(isNaN(t)||isNaN(n))alert("Таких координат нет на доске");else{if(!(t<0||t>=model.boardSize||n<0||n>=model.boardSize))return t+n;alert("Это находится где-то за пределами игрового поля")}return null}alert("Координаты выстрела должны состоять из буквы и цифры. Например: A2")}(e);s&&(this.guesses++,view.displayGuesses("Попыток: "+this.guesses),model.fire(s)&&model.shipsSunk===model.numShips&&view.displayMessage("Ты потопил все корабли за "+this.guesses+" выстрелов"))}};window.onload=init;